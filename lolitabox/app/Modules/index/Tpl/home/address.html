<include file="public:header.inc" />
<script src="/public/js/validform.js"></script>
<link rel="stylesheet" type="text/css" href="public/css/validform.css"/>
<!--公用---头部--end------->

<!--分页--start-->
<div class="fm1020 top_guide">
	所在位置：<a href="/">网站首页</a> > <a href="<{:u('home/index')}>">个人主页</a> > <span class="g9">收货地址</span>
</div>
<!--分页--end-->

<!--个人中心--内容--start-------->
<div class="fm1020_b cfl">
	<!--左侧导航--->
	<include file="left.inc" />
	
	
	<!--右侧-内容-->
	<div class="f738 r wp738">
		<!--分享详情页内容-->
		<include file="info.inc" />
		
		<div class="main My_details_wrap">
			<!---创建新地址--->
			<div class="user_location cfl" >
			     <div id="ajax_content">
			          <include file="address_form" />
			     </div>
				<notempty name="return.list">
				<div class="user_message cfl">
					<div class="user_info_t">
						<span>已保存的地址</span>
					</div>
					<div class="W_order_wrap">
							<table class="order_tables" border="0" cellspacing="0" cellpadding="0" width="100%">
								<tbody><tr height="46">
								<th width="10%">默认</th>
									<th width="10%">姓名</th>
									<th width="15%">手机号码</th>
									<th width="35%">收货地址</th>
									<th width="10%">邮政编码</th>
									<th width="15%">操作</th>
								</tr>
								<volist name="return.list"  id="vo">
								<tr <eq name="vo.if_active"  value="1"> style="background-color:#FFFF99;"</eq>>
									<td><eq name="vo.if_active"  value="1"><p><span class="S_txt1">当前默认</span><else/><a class="A_line3" href="javascript:void()"  onclick="set('<{$vo.id}>',this)">设为默认</a></p></eq></td>
									<td><{$vo.linkman}></td>
									<td><{$vo.telphone}></td>
									<td><p><{$vo.province}> <{$vo.city}> <{$vo.district}> <{$vo.address}></p></td>
									<td><{$vo.postcode}></td>
									<td>
									 <a class="A_line3" href="javascript:void(0)"   onclick='edit(<{$vo.json}>)'   >编辑</a>  <span class="S_txt2">|</span>  <a class="A_line3" href="javascript:void()"  onclick="if(confirm('您确认删除地址吗?'))del('<{$vo.id}>',this);return false;">删除</a>
									 </td>
								</tr>
								</volist>
							</tbody>
							</table>
					</div>
				</div>
				<b>温馨提示：</b>默认地址是网站活动实物奖品的派送地址，如用户在参与网站活动中获得了实物奖品，在无特殊声明情况下，均会通过用户设定的“默认地址”进行派送。
				</notempty>
			</div>
		
			<div class="hei1"></div>
		</div>
		<div class="ft"></div>
	</div>
</div>
<script>
//删除我的收货地址
function del(id,obj){
	$.ajax({
		url:"__URL__/del_address.html",
		type:"post",
		dataType:"json",
		data:"id="+id,
		success:function(chkresult){
			if(chkresult.status==1){
				y_dialog("删除成功",2,function(){
					location.reload();
				},obj);
			}else {
				n_dialog("删除失败",2,false,obj);
			}
			
		}
	})
}

function set(id,obj){
	$.ajax({
		url:"__URL__/set_address.html",
		type:"post",
		dataType:"json",
		data:"id="+id,
		success:function(chkresult){
			if(chkresult.status==1){
				y_dialog("设置成功",3,function(){
					location.reload();
				},obj);
			}
			else {
				n_dialog("设置失败",3,false,obj);
			}
			
		}
	})
}


function edit(json){
	if($(".address_frm").length==0){
		$.ajax({
			url:"<{:u('home/address_form')}>",
			type:"post",
			dataType:"html",
			async:false,
			success:function(data){
				$("#ajax_content").html(data);
			}
		})
	}
	$(".header_address").html("<span>编辑收货地址</span>");
	$("#id").val(json.id);
	$("#linkman").val(json.linkman);
	$("#telphone").val(json.telphone);
	$("#s1").val(json.province);
	$("#s2").val(json.city);
	$("#s3").val(json.district);
	$("#postcode").val(json.postcode);
	$("#address").val(json.address);
	$("#if_active").attr("checked",parseInt(json.if_active)==1 ? true:false);
}
</script>

<!--标准底---start--->
<include file="public:footer.inc" />
