<include file="Public:header" />
<style>
    li { width: 100%; list-style-type:none; float: left; margin-top: 5px}
    em {color: red}
</style>
<table width="100%" cellspacing="1" cellpadding="6" border="0" align="center" class="tborder">
<tbody>
<tr>
    <td class="tcat">新增投递</td>
</tr>
<tr>
<td align="center" class="panelsurround">
<form id='product_create_form' action="__URL__/addproduct" method="post">
    <input type="hidden" name="pid" value="{$productinfo.pid}">
    <div class="panel">
        <div align="left">
            输入库存ID:<input type="text" size="10" name="inventory_item_id" value="{$productinfo.inventory_item_id}">  </br> </br>
            <div id="inventoryItemInfo"></div>
            <fieldset class="fieldset">
                <legend>投递属性设置</legend>
                <div style='width:50%;float:left'>
                    <ul style="float: left">
                        <li>
                            <div style="float: left">
                                <em>*</em><label>单品名称：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" size="30" name="pname" value="{$productinfo.pname}" tip="填写单品名称" altercss="gray" errormsg="格式：2-10个字符（可包含汉字、数字、字母及下划线）" nullmsg="请您输入单品名称" datatype="s2-10">
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em></em><label>状态：</label>
                            </div>
                            <div style="float: left">
                                <select name="status">
                                    <option value="0"
                                    <php>if($productinfo["status"] == 1) echo " selected";</php>>开放</option>
                                    <option value="1"
                                    <php>if($productinfo["status"] == 0) echo " selected";</php>>>关闭</option>
                                </select>
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em>*</em><label>普通订阅价格：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" name="price" value='{$productinfo.price}' tip="填写金额" altercss="gray" errormsg="格式：两位小数" nullmsg="请填写正确金额" datatype="price">(元)
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em>*</em><label>高级订阅价格：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" name="member_price" value='{$productinfo.member_price}' tip="填写金额" altercss="gray" errormsg="格式：两位小数" nullmsg="请填写正确金额" datatype="price">(元)
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em></em><label>最大限购：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" name="max_peruser" value='{$productinfo.max_peruser}' tip="填写整数" altercss="gray" errormsg="格式：数字" data-type="n1-16">(个)
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em>*</em><label>开始日期：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" size="20" id="start_time" name="start_time" value='{$productinfo.start_time}' >
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em>*</em><label>截止日期：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" size="20" id="end_time" name="end_time" value='{$productinfo.end_time}'>
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em>*</em><label>投递数目：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" name="inventory" value='{$productinfo.inventory}' tip="填写整数" altercss="gray" errormsg="格式：数字" nullmsg="请填写正确数字" datatype="n1-16">(个)
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div style='width:50%;float:left'>
                    <ul style="float: left">
                        <li>
                            <div style="float: left">
                                <em></em><label>推荐属性标签：</label>
                            </div>
                            <div style="float: left">
                                <select name="commend_tag">
                                    <option value="0"
                                    <php>if($productinfo["commend_tag"] == 0) echo " selected";</php>>全不选</option>
                                    <option value="1"
                                    <php>if($productinfo["commend_tag"] == 1) echo " selected";</php>>最新</option>
                                    <option value="2"
                                    <php>if($productinfo["commend_tag"] == 2) echo " selected";</php>>推荐</option>
                                    <option value="3"
                                    <php>if($productinfo["commend_tag"] == 3) echo " selected";</php>>最热</option>
                                    <option value="4"
                                    <php>if($productinfo["commend_tag"] == 4) echo " selected";</php>>折扣</option>
                                    <option value="5"
                                    <php>if($productinfo["commend_tag"] == 5) echo " selected";</php>>正装</option>
                                </select>
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em></em><label> 编辑亮点：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" size="20" name="spot" value='{$productinfo.spot}'>
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em></em><label> 专题链接：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" size="20" name="project_url" value='{$productinfo.project_url}'>
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em></em><label> 不计运费：</label>
                            </div>
                            <div style="float: left">
                                <input type=checkbox value="1" name="need_postage"
                                <php>if($productinfo["need_postage"]==1) echo " checked";</php>
                                 />
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em></em><label> 进行预告：</label>
                            </div>
                            <div style="float: left">
                                <input type=checkbox value="1" name="need_pre_share"
                                <php>if($productinfo["need_pre_share"]==1) echo " checked";</php>
                                />
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em>*</em><label>预告排序：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" name="pre_share_sort_num" value="{$productinfo[pre_share_sort_num]}"/>
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em>*</em><label>投递排序：</label>
                            </div>
                            <div style="float: left">
                                <input type="text" name="sort_num" value="{$productinfo[sort_num]}"/>
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                        <li>
                            <div style="float: left">
                                <em>*</em><label>投递区域：</label>
                            </div>
                            <div style="float: left" >
                                <input type=checkbox value="0" name="user_type[]" class="user_type"
                                <php>if(in_array(0,$usertype_list_selected)) echo " checked";</php>
                                >普通会员</input>
                                <input type=checkbox value="1" name="user_type[]" class="user_type"
                                <php>if(in_array(1,$usertype_list_selected)) echo " checked";</php>
                                >高级用户</input>
                                <input type=checkbox value="2" name="user_type[]" class="user_type"
                                <php>if(in_array(2,$usertype_list_selected)) echo " checked";</php>
                                >年度用户</input>
                                <input type=checkbox value="3" name="user_type[]" class="user_type"
                                <php>if(in_array(3,$usertype_list_selected)) echo " checked";</php>
                                >新用户
                                </input>
                            </div>
                            <div class="tips" style="float: left; width: 150px">
                                <div class="Validform_checktip" ></div>
                            </div>
                        </li>
                    </ul>
                </div>
            </fieldset>
        </div>
    </div>
    <div>
        <input type="submit" class="button" value="提交表单"/>
    </div>
</form>
</td>
</tr>
</tbody>
</table>
<script>
    var id="{$Think.request.pid}";
    var url="__URL__/editproduct";
    if(id){
        $("#product_create_form").attr("action",url);
    }
    $("#start_time").datetimepicker({
        dateFormat:"yy-mm-dd",
        timeFormat : "HH:mm:ss",
        changeMonth: true,
        numberOfMonths: 1,
        onSelect: function( selectedDate ) {
            $( "#end_time" ).datepicker( "option", "minDate", selectedDate );
        }
    });

    $("#end_time").datetimepicker({
        dateFormat:"yy-mm-dd",
        timeFormat : "HH:mm:ss",
        changeMonth: true,
        numberOfMonths: 1,
        onSelect: function( selectedDate ) {
            $( "#start_time" ).datepicker( "option", "maxDate", selectedDate );
        }
    });
    $(function(){
        $("#product_create_form").Validform({
            tiptype:2,
            datatype:{
                "price": /^([1-9][\d]{0,7}|0)(\.[\d]{1,2})?$/
            },
            beforeSubmit:function(curform){
                var flag = false;
                var userTypes = $(".user_type");
                $.each(userTypes, function (index, ele) {
                    if ($(ele).attr("checked")) {
                        flag = true;
                    }
                })
                if(!flag){
                    alert("请选择投递区域");
                    return false;
                }
                if(!$("#start_time").val() || !$("#end_time").val()){
                    alert("请选择开始时间和结束时间");
                    return false;
                }
                return true;
            } ,
            ajaxPost:true,
            callback:function(data){
                alert(data.info);
            }
        });
    })
</script>
<include file="Public:footer"/>