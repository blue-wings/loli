<include file="Public:header" />
<style>
ul{
	list-style:none;
}
li{
	line-height:20px;
}
.formstyle{
	height:50px;
	width:500px;
}
.prompt{
	color:#804000;
	font-size:12px;
	margin-top:-5px;
}
a.redstyle{
	color:#FF0000;
}
a.addstyle{
	color:#804000;
}
input{
	border-color:#008080;
}
</style>
<script type="text/javascript">
function areaManipulate(areaid,action,name){
	if(action == 'edit_area'){
		//修改
		$("#prompt").text("请输入您要修改的名称:");
		$("input[name='action']").val(action);
		$("input[name='oldname']").val(areaid);
		$(".formstyle").show('slow');
		$("input[name='newname']").val(name).focus();
	}else if(action == 'add_area'){
		//增加
		$("#prompt").text("请输入您要添加的名称:");
		$("input[name='action']").val(action);
		$("input[name='oldname']").val(areaid);
		$(".formstyle").show('slow');
		$("input[name='newname']").focus();
	}else if(action == 'del_area'){
		//删除
		delArea(areaid,action);
	}else if(action == 'addProvince'){
		$("#prompt").text("请输入您要添加的省级名称:");
		$("input[name='action']").val(action);
		$("input[name='oldname']").val(areaid);
		$(".formstyle").show('slow');
		$("input[name='newname']").focus();
	}
}

function delArea(areaid,action){
	$.post("__URL__/areaManipulate",{areaid:areaid,action:action},function(ret){
			if(ret.status == 1){
				alert('删除成功!');
				location.reload();
			}else{
				alert("删除失败,请检查问题!");
			}	
	},'json');
}

$(document).ready(function(){
	$("input[name='search']").focus().keyup(function(){
		$("ul").hide();
		$("ul li").filter(":contains('"+( $(this).val() )+"')").parent().show();
	})
	$(":button[name='addProvince']").bind('click',function(){
		areaManipulate('0','addProvince');
	})
})

</script>
<div style="widht:50%;padding:10px;">
	<p><input type="button" value="新增省级名称" name="addProvince">
	<a href="__URL__/createAreaJsonFile/exportType/JS">输出JSON数据文件</a></p>
	<p>查找:<input name="search" type="text"></p>
	<div class="formstyle" style="display:none;padding-top:10px;">
		<form action="__URL__/areaManipulate" method="POST">
			<p><div id="prompt" class="prompt"></div><input type="text" value="" name="newname" class="promptstyle">
			<input type="hidden" value="" name="action">
			<input type="hidden" value="" name="oldname">
			<input type="submit" value="提交" name="sub"></p>
		</form>
	</div>
</div>

<volist name="alist" id="top">
<ul>
	<li>
	{$top.first.title}&nbsp;&nbsp;&nbsp;
		<a href="#" onclick="return areaManipulate('{$top.first.area_id}','add_area')" class="addstyle">增加</a>/
		<a href="#" onclick="return areaManipulate('{$top.first.area_id}','edit_area','{$top.first.title}')">编辑</a>/
		<a href="#" onclick="return areaManipulate('{$top.first.area_id}','del_area')" class="redstyle">删除</a>
	</li>
	<li>&nbsp;</li>
	<li>
		<volist name="top.second" id="second">
			<ul>
				<li>
					&nbsp;|--	{$second.superior.title} &nbsp;&nbsp;&nbsp;
						<a href="#" onclick="return areaManipulate('{$second.superior.area_id}','add_area')" class="addstyle">增加</a>/
						<a href="#" onclick="return areaManipulate('{$second.superior.area_id}','edit_area','{$second.superior.title}')">编辑</a>/
						<a href="#" onclick="return areaManipulate('{$second.superior.area_id}','del_area')" class="redstyle">删除</a>
				</li>
				<li>&nbsp;</li>
				<li>
					<volist name="second.subordinate" id="sub">
						<ul>
							<li>
								&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	|--	{$sub.title} &nbsp;&nbsp;&nbsp;
								<a href="#" onclick="return areaManipulate('{$sub.area_id}','edit_area','{$sub.title}')">编辑</a>/
								<a href="#" onclick="return areaManipulate('{$sub.area_id}','del_area')" class="redstyle">删除</a>
							</li>
						</ul>
					</volist>
				</li>
				<li>&nbsp;</li>
			</ul>
		</volist>
	</li>
	<li>&nbsp;</li>
	<li>&nbsp;</li>
</ul>
</volist>

<include file="Public:footer" />