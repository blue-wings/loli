<include file="Public:header" />
<link rel="stylesheet" href="__PUBLIC__/js/colorbox/colorbox.css">
<script src="__PUBLIC__/js/colorbox/jquery.colorbox-min.js"></script>
<style>
.tawid{
	height:25px;
	border-collapse:collapse;
	width:90%;
}

.tawid tr{height:28px;}
.tawid td{ border:1px solid #666; border-collapse:collapse; text-align:center;}
.tb1{width:800px}
.valnull{font-weight:bolder;color:#FF8040;};
.datalist{border:0;}
</style>
	<div align="left">
		<fieldset class="fieldset"><legend>查询条件<a href="#relp" class="record"></a></legend>
			<form action="__ACTION__" method="get" id="myform">
			  时间: 
<label for="from">From</label>
<input type="text" id="from" name="start" value="{$Think.request.start}" size="15">
<label for="to">to</label>
<input type="text" id="to" name="end" value="{$Think.request.end}"  size="15"/>
<input type="submit"   value=" 提 交 "><br><br>
<if condition="$total elt 90">
    <a class='inline' href="#time_pic"  style='color:red'>查看实时折线图(按天汇总)</a>
      &nbsp;&nbsp;&nbsp;&nbsp;
</if>
<a class='inline' href="#all_pic" style='color:red'>查看全局折线图(按月汇总)</a>&nbsp;&nbsp;&nbsp;&nbsp;	PS:实时折线图是根据查询条件生成的折线图，而全局折线图是将所有数据按月汇总生成	
 </form>
		</fieldset>			
	</div>

<table cellpadding="0" cellspacing="0" class="tawid">
	<tr bgcolor="#f5f5f5"  id="awarp">
		<td width="15%">时间</td>
		<td width="8%">注册总数</td>
		<td width="8%">萝莉盒订单数</td>
		<td width="8%">萝莉盒销售额</td>
		<td width="8%">萝莉盒折扣额</td>
		<td width="8%">积分订单数</td>
		<td width="8%">积分销售额</td>
		<td width="8%">付邮订单数</td>
		<td width="8%">付邮销售额</td>
		
		<td width="10%">售出产品总额</td>
	</tr>
	<volist name="statlist" id='vo'>
	<tr>
		<td>{$vo.statdate}</td>
		<td><a href="javascript:void(0)" onclick="querylist('{$vo.statdate}','registernum')">{$vo.registernum}</a></td>
		<td><a href="javascript:void(0)" onclick="querylist('{$vo.statdate}','ordernum')">{$vo.ordernum}</a></td>
		<td>{$vo.sales}</td>
		<td>{$vo.discount}</td>
		<td><a href="javascript:void(0)" onclick="querylist('{$vo.statdate}','ordernum_exchange')">{$vo.ordernum_exchange}</a></td>
		<td>{$vo.sales_exchange}</td>
		<td><a href="javascript:void(0)" onclick="querylist('{$vo.statdate}','ordernum_postage')">{$vo.ordernum_postage}</a></td>
		<td>{$vo.sales_postage}</td>
		
		<td>{$vo.totalvalue}</td>
	</tr>
	</volist>
	<script>
		function querylist(time,flag){
			$.post("__ACTION__",{time:time,query:flag},function(rep){
				$("#relp").html(rep);
				$("a.record").click();
			})
		}		
	</script>
	<tr>
</table>
<br>
<table cellpadding="0" cellspacing="0" class="tawid">
	<tr bgcolor="#f5f5f5">
		<td width="15%">时间</td>
		<td width="8%">注册总数</td>
		<td width="8%">萝莉盒订单数</td>
		<td width="8%">萝莉盒销售额</td>
		<td width="8%">萝莉盒折扣额</td>
		<td width="8%">积分订单数</td>
		<td width="8%">积分销售额</td>
		<td width="8%">付邮订单数</td>
		<td width="8%">付邮销售额</td>
		<td width="10%">售出产品总额</td>
		<td width="10%">萝莉产品总额</td>
		<td width="10%">订单产品均价</td>
		<td width="10%">订单\注册转化率</td>
		<td width="10%">折扣率</td>
		<td width="10%">变现率</td>
		
	</tr>
	<tr>
		<td>{$Think.request.start}到{$Think.request.end}</td>
		<td>{$list.registernum}</td>
		<td>{$list.ordernum}</td>
		<td>{$list.sales}</td>
		<td>{$list.discount}</td>
		<td>{$list.ordernum_exchange}</td>
		<td>{$list.sales_exchange}</td>
		<td>{$list.ordernum_postage}</td>
		<td>{$list.sales_postage}</td>
		<td>{$list.totalvalue_all}</td>
		<td>{$list.totalvalue}</td>
		<td>{$list[totalvalue]/$list[ordernum]|round=###,2}</td>
		<td>{$list[reg_order_num]/$list[registernum]*100|round=###,2}%</td>
	    <td>{$list[discount]/($list[discount]+$list[sales])*100|round=###,2}%</td>
	    <td>{$list[sales_bianxian]/$list[totalvalue]*100|round=###,2}%</td>
	</tr>
</table>
<if condition="$total elt 90">
<div style="display:none">
<div id="time_pic" >
<img src="__ACTION__/start/{$Think.request.start}/end/{$Think.request.end}/load/img/type/registernum">
<img src="__ACTION__/start/{$Think.request.start}/end/{$Think.request.end}/load/img/type/ordernum">
<img src="__ACTION__/start/{$Think.request.start}/end/{$Think.request.end}/load/img/type/sales">
<img src="__ACTION__/start/{$Think.request.start}/end/{$Think.request.end}/load/img/type/discount">
<img src="__ACTION__/start/{$Think.request.start}/end/{$Think.request.end}/load/img/type/totalvalue">
</div>
</div>
</if>
<div   style="display:none">
<div id="all_pic">
<img src="__ACTION__/load/all/type/registernum">
<img src="__ACTION__/load/all/type/ordernum">
<img src="__ACTION__/load/all/type/sales">
<img src="__ACTION__/load/all/type/discount">
<img src="__ACTION__/load/all/type/totalvalue">
</div>
</div><br>
<div style="display:none">
	<div id="relp"></div>
</div>

<script>
$(".inline").colorbox({inline:true, width:"95%",height:"85%"});
$(".record").colorbox({inline:true, width:"95%",height:"85%"});

jQuery(function($){
	$.datepicker.regional['zh-CN'] = {
		closeText: '关闭',
		prevText: '&#x3c;上月',
		nextText: '下月&#x3e;',
		currentText: '今天',
		monthNames: ['一月','二月','三月','四月','五月','六月',
		'七月','八月','九月','十月','十一月','十二月'],
		monthNamesShort: ['一','二','三','四','五','六',
		'七','八','九','十','十一','十二'],
		dayNames: ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],
		dayNamesShort: ['周日','周一','周二','周三','周四','周五','周六'],
		dayNamesMin: ['日','一','二','三','四','五','六'],
		weekHeader: '周',
		dateFormat: 'yy-mm-dd',
		firstDay: 1,
		isRTL: false,
		showMonthAfterYear: true,
		yearSuffix: '年'};
		$.datepicker.setDefaults($.datepicker.regional['zh-CN']);
});

$( "#from" ).datepicker({
	defaultDate: "-1w",
	changeMonth: true,
	numberOfMonths: 1,
	onSelect: function( selectedDate ) {
		$( "#to" ).datepicker( "option", "minDate", selectedDate );
	}
});
$( "#to" ).datepicker({
	defaultDate: "+1w",
	changeMonth: true,
	numberOfMonths: 1,
	onSelect: function( selectedDate ) {
		$( "#from" ).datepicker( "option", "maxDate", selectedDate );
	}
});


</script>
<include file="Public:footer" /> 